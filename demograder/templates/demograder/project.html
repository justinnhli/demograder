{% extends "demograder/base.html" %}

{% block breadcrumb %}
<!-- begin demograder/project.html:breadcrumb -->
<a href="{% url 'index' %}">Home</a>
&gt;
<a href="{% url 'course' project.course.id %}">{{ project.course.catalog_id }}</a>
&gt;
<a href="{% url 'project' project.id %}">{{ project.name }}</a>
<!-- end demograder/project.html:breadcrumb -->
{% endblock %}

{% block content %}
<!-- begin demograder/project.html:content -->
<h2>Project: {{ project.name }}</h2>

<h3>Submit</h3>
<p><a href="{% url 'project_upload' project.id %}">Upload New Version</a></p>

{% if submission %}

	<h3>Test Results: {{ submission.score }}/{{ submission.max_score }}</h3>
	<p>
		From
		{{ submission.us_format }}
		{% if submission == latest %}
			(most recent submission)
		{% else %}
			(<a href="{% url 'submission' latest.id %}">see most recent submission</a>)
		{% endif %}
	</p>
	<p>
		Uploads:
		{% for upload in submission.upload_set.all %}
			{% if not forloop.first %},{% endif %}
			{% if user.is_superuser %}
				<a href="{% url 'display' upload.id %}">{{ upload.basename }}</a>
			{% else %}
				<a href="{% url 'download' upload.id %}">{{ upload.basename }}</a>
			{% endif %}
		{% endfor %}
	</p>
	{% if results %}
		<div id="scoreboard">
			{% for result in results %}
				{% if result.return_code == None %}
					<a class="score tbd" href="{% url 'result' result.id %}">TBD</a>
				{% elif result.return_code == 0 %}
					<a class="score pass" href="{% url 'result' result.id %}">Pass</a>
				{% else %}
					<a class="score fail" href="{% url 'result' result.id %}">Fail</a>
				{% endif %}
			{% endfor %}
		</div>
	{% else %}
		There are no results associated with this submission.
	{% endif %}

	<h3 id="history-heading">
		Submission History
		{% if user.is_superuser %}
			for <a href="{% url 'instructor_student' submission.student.id %}">{{ submission.student.name }}</a>
		{% endif %}
	</h3>
	<div id="history">
		<table>
			<tr>
				<th>Date/Time</th>
				<th>File(s)</th>
				<th>Tests Passed</th>
			</tr>
			{% for submission in submissions %}
			<tr>
				<td><a href="{% url 'submission' submission.id %}">{{ submission.us_format }}</a></td>
				<td>
					{% for upload in submission.upload_set.all %}
						{% if not forloop.first %},{% endif %}
						{% if user.is_superuser %}
							<a href="{% url 'display' upload.id %}">{{ upload.basename }}</a>
						{% else %}
							<a href="{% url 'download' upload.id %}">{{ upload.basename }}</a>
						{% endif %}
					{% endfor %}
				</td>
				<td>
					{% if submission.max_score %}
						{{ submission.score }}/{{ submission.max_score }}
					{% else %}
						N/A
					{% endif %}
				</td>
			</tr>
			{% endfor %}
		</table>
	</div>

{% else %}
	You have not submitted to this project.
{% endif %}

<!-- end demograder/project.html:content -->
{% endblock %}
